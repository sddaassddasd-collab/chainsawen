<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é»æ“Šé–‹å§‹é‰…æ¨¹ (Click to Start Sawing the Tree)</title>
  <style>
    :root { --radius: 16px; }
    html, body {
      height: 100%; margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", "Helvetica Neue", Arial, sans-serif;
      background: #f6f7fb; color: #111;
    }
    .wrap { min-height: 100%; display: grid; place-items: center; padding: 24px; }
    .card {
      width: 100%; max-width: 520px; background: #fff;
      border-radius: var(--radius); box-shadow: 0 8px 30px rgba(0,0,0,.08);
      padding: 28px;
    }
    .title { margin: 0 0 12px; font-size: 22px; font-weight: 700; letter-spacing: .02em; }
    .status { margin: 6px 0 18px; font-size: 18px; min-height: 1.6em; color: #333; }
    .row { display: flex; gap: 12px; align-items: center; }
    button.cta {
      flex: 1; border: 0; background: #0ea5e9; color: #fff;
      padding: 14px 18px; border-radius: 999px;
      font-size: 18px; font-weight: 700; cursor: pointer;
      box-shadow: 0 6px 20px rgba(14,165,233,.35);
      transition: transform .02s ease, box-shadow .2s ease;
    }
    button.cta:active { transform: translateY(1px) scale(.998); }
    button.cta:disabled { background: #9ca3af; box-shadow: none; cursor: not-allowed; }
    .pill { background: #eef2ff; color: #3730a3; padding: 8px 12px; border-radius: 999px; font-size: 14px; font-weight: 700; }
    .bar { height: 12px; background: #e5e7eb; border-radius: 999px; margin-top: 12px; overflow: hidden; }
    .bar > div { height: 100%; width: 0%; background: linear-gradient(90deg,#22c55e,#4ade80); transition: width .12s ease; }
    .toast { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(0,0,0,.45); opacity: 0; pointer-events: none; transition: opacity .25s ease; }
    .toast.show { opacity: 1; pointer-events: auto; }
    .toast .box {
      background: #fff; padding: 28px 24px; border-radius: var(--radius);
      width: min(90vw,520px); text-align: center; box-shadow: 0 12px 40px rgba(0,0,0,.18);
      animation: pop .25s ease;
    }
    .toast h2 { margin: 0 0 10px; font-size: 24px; }
    .toast p { margin: 0 0 16px; color: #444; }
    .toast .actions { display: flex; gap: 10px; justify-content: center; }
    .ghost { background: #111; color: #fff; }
    @keyframes pop { from { transform: scale(.96); opacity: 0 } to { transform: scale(1); opacity: 1 } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="group" aria-label="é»ç”Ÿé‹¸æ¨¹ (Li Sheng Sawing Game)">
      <h1 class="title">é»æ“Šé–‹å§‹é‰…æ¨¹ (Click to Start Sawing)</h1>
      <div id="status" class="status" aria-live="polite">ï¼ˆé‚„æ²’é–‹å§‹ï¼‰(Not started yet)</div>
      <div class="row">
        <button id="sawBtn" class="cta" type="button">é–‹å§‹é‹¸ï¼ (Start Sawing!)</button>
        <span id="counter" class="pill" aria-label="ç›®å‰é€£é»æ•¸ (Current combo count)">0 / 100</span>
      </div>
      <div class="bar" aria-hidden="true"><div id="progress"></div></div>
      <div class="hint">æç¤º (Hint)ï¼šè¦ <strong>å¿«é€Ÿé€£é»</strong> ï¼Œé€£çºŒæ¯ä¸€ä¸‹é–“éš” â‰¤ <span id="ms">2000</span> msï¼Œ<br>è‹¥è¶…éå°±æœƒé‡ç½®è¨ˆæ•¸ã€‚Tap quickly! Each tap must be within 2000 ms, or the counter resets.</div>
    </div>
  </div>

  <div id="toast" class="toast" role="dialog" aria-modal="true" aria-labelledby="doneTitle" aria-describedby="doneDesc">
    <div class="box">
      <h2 id="doneTitle">ä½ æŠŠæ¨¹é‹¸é–‹äº† ğŸŒ³ğŸ‰ (You sawed the tree!)</h2>
      <p id="doneDesc">æ­å–œï¼Œä½ å¯ä»¥ä¸Šç­äº†ï¼ (Congrats, you can go to work!)</p>
      <div class="actions">
        <button id="close" class="ghost" type="button">é—œé–‰ (Close)</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const TARGET = 100;              // éœ€è¦é€£é»çš„æ¬¡æ•¸ (required taps)
      const THRESHOLD_MS = 2000;       // æ¯ä¸€ä¸‹çš„æœ€å¤§é–“éš”ï¼ˆæ¯«ç§’ï¼‰æ”¹æˆ 2000 ms

      const btn = document.getElementById('sawBtn');
      const status = document.getElementById('status');
      const counter = document.getElementById('counter');
      const progress = document.getElementById('progress');
      const toast = document.getElementById('toast');
      const close = document.getElementById('close');
      const ms = document.getElementById('ms');

      ms.textContent = THRESHOLD_MS;

      let combo = 0;
      let last = 0;
      let started = false;
      let finished = false;

      function updateUI() {
        counter.textContent = `${combo} / ${TARGET}`;
        progress.style.width = `${Math.min(combo / TARGET * 100, 100)}%`;
      }

      function reset(all = false) {
        combo = 0; last = 0; finished = false;
        if (all) {
          started = false;
          status.textContent = 'ï¼ˆé‚„æ²’é–‹å§‹ï¼‰(Not started yet)';
          btn.textContent = 'é–‹å§‹é‹¸ï¼ (Start Sawing!)';
          btn.disabled = false;
        } else if (started) {
          status.textContent = 'æ¨¹é‚„æ²’é‹¸é–‹ (Tree not cut yet)';
        }
        updateUI();
      }

      function success() {
        finished = true;
        btn.disabled = true;
        status.textContent = 'ä½ æŠŠæ¨¹é‹¸é–‹äº† (You sawed the tree)';
        toast.classList.add('show');
      }

      btn.addEventListener('click', () => {
        const now = performance.now();
        if (!started) {
          started = true;
          status.textContent = 'æ¨¹é‚„æ²’é‹¸é–‹ (Tree not cut yet)';
          btn.textContent = 'ç¹¼çºŒé‹¸ï¼ (Keep Sawing!)';
          combo = 0;
        }
        if (last === 0 || now - last <= THRESHOLD_MS) {
          combo += 1;
        } else {
          combo = 1; // è¶…æ™‚ï¼Œå¾é ­é–‹å§‹é€£é» (timeout -> reset combo)
        }
        last = now;
        updateUI();
        if (!finished && combo >= TARGET) success();
      });

      close.addEventListener('click', () => toast.classList.remove('show'));

      btn.addEventListener('keydown', (e) => {
        if (e.code === 'Space' || e.code === 'Enter') {
          e.preventDefault();
          btn.click();
        }
      });

      reset(true);
    })();
  </script>
</body>
</html>